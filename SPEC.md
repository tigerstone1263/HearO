# HearO 기획-스펙-체크리스트

## 0. 문서 목적
- 기획 문서를 코드에 직접 연결할 수 있도록 스펙과 작업 체크리스트를 한 곳에서 관리한다.
- 모든 구현 작업은 본 문서의 작업 항목을 먼저 갱신한 뒤 진행한다.

## 1. 프로젝트 개요
- 게임명: HearO (히어로)
- 장르: 2D 탑다운 청음 교육 RPG (Roguelike-ish)
- 플랫폼: Web & Mobile (Android/iOS) - 가로 모드 고정
- 핵심 기술: Flutter, Flame Engine
- 컨셉: 뱀파이어 서바이벌 UI/UX를 차용한 직관적인 청음 훈련 게임

## 2. 시스템 사양 및 환경
| 구분 | 상세 내용 | 비고 |
| --- | --- | --- |
| 개발 프레임워크 | Flutter (Flame Engine) | 멀티플랫폼 대응 |
| 화면 방향 | Landscape (가로 모드) | Web에서도 16:9 비율 유지 권장 |
| 사운드 시스템 | MIDI 사운드 또는 고음질 샘플링 음원 | 청음 교육의 핵심 |
| 해상도 | 가변 해상도 대응 (Responsive Layout) |  |

## 3. 상세 스펙 (Functional Specs)

### 3.1 캐릭터 (Player)
- 위치: 화면 중앙 고정 (카메라가 캐릭터를 추적)
- 이동: 좌측 하단 가상 조이스틱으로 8방향 이동
- 청음 영역 (Listening Circle)
  - 캐릭터 발밑에 본인 크기의 약 3배인 반투명 원 표시
  - 몬스터가 이 원 안에 진입할 경우 해당 몬스터의 고유 음계(Pitch)가 재생됨
- 체력 시스템
  - 기본 하트 12개 소지
  - 몬스터 충돌 시 하트 1개 감소
  - 하트 0 도달 시 게임 오버 및 결과 화면 노출

### 3.2 몬스터 (Monsters)
- 일반 패턴: 캐릭터를 향해 등속도로 돌진
- 상호작용
  - 정답: 몬스터의 음과 일치하는 건반 입력 시 몬스터 소멸 -> 황금 음표 보상 드랍
  - 오답: 몬스터가 분노 상태로 변화 (붉은색 이펙트 + 이동속도 대폭 증가)
- 보상: 난이도(음계 복잡도)가 높을수록 드랍되는 황금 음표의 크기와 점수 증가

### 3.3 인터페이스 (UI/UX)
- 인게임 UI
  - 좌측 하단: 가상 조이스틱 (이동)
  - 우측 하단: 투명 피아노 건반 (입력부, 최소 도~시 대응)
  - 상단 중앙: 캐릭터 체력(하트) 및 진행 시간/점수
- 피아노 건반: 터치/클릭 시 시각적 피드백(눌림 효과) 및 해당 음 재생

### 3.4 레벨 디자인 및 난이도 곡선
- 난이도 상승: 30초마다 스테이지(페이즈) 전환

| 스테이지 | 시간 | 등장 음계 | 특징 |
| --- | --- | --- | --- |
| Stage 1 | 00~30s | 도, 레, 미 | 매우 느린 이동 속도 |
| Stage 2 | 30~60s | 도, 레, 미, 파, 솔 | 이동 속도 증가 |
| Stage 3 | 60~90s | 도~시 (1옥타브) | 빠른 이동 속도 |
| Stage 4 | 90s~종료 | 보스전 (도~시) | 고정형 보스, 원거리 공격, 하트 5개 |

- 보스전 (Stage 4)
  - 중앙 또는 특정 위치에 고정됨
  - 사용자가 음을 맞출 때마다 보스의 하트가 0.5개 감소 (총 10회 정답 필요)
  - 정답 처리 시 보스의 음계가 랜덤하게 재설정됨

## 4. 작업 체크리스트

### Phase 0. 문서/워크플로 세팅
- [x] P0-01 문서/워크플로 정비 (템플릿/훅/규칙 정착)
  - 구현 피처: 스펙/체크리스트 문서 정리, 커밋 템플릿 및 훅 적용
  - 연관 피처: 전체 작업 절차와 커밋 단위 관리
  - 검증:
    - `git commit` 시 템플릿이 적용되는지, 작업 단위 커밋이 유지되고 문서/코드 연동 조건이 지켜지는지 확인

- [ ] P0-02 기본 테스트 템플릿 정비
  - 구현 피처: 기본 위젯 테스트를 현재 앱 구조에 맞게 갱신
  - 연관 피처: 테스트 러너/CI
  - 검증:
    - `flutter test` 실행이 성공함

### Phase 1. 환경 구축 및 캐릭터
- [x] P1-01 Flutter Flame 프로젝트 셋업 (Web/Mobile 타겟)
  - 구현 피처: Flutter/Flame 기본 실행, Web/모바일 빌드 타겟 준비, 가로 모드 전제 구성
  - 연관 피처: 모든 런타임/입력/렌더링 구성의 기반
  - 검증:
    - `flutter run -d chrome` 실행이 성공하고 기본 화면이 정상 렌더링
    - 모바일 타겟에서도 기본 런치가 가능한지 확인

- [x] P1-02 캐릭터 스프라이트 시트 애니메이션 (Idle/Walk)
  - 구현 피처: 플레이어 스프라이트 로딩, Idle/Walk 애니메이션 전환 (임시 placeholder 시트 사용)
  - 연관 피처: 입력 이동 로직, 상태 기반 애니메이션
  - 검증:
    - 방향키 입력 시 Walk 애니메이션으로 전환
    - 입력이 없을 때 Idle 애니메이션으로 복귀

- [x] P1-03 좌측 하단 조이스틱 연동 및 8방향 이동
  - 구현 피처: 가상 조이스틱 입력, 8방향 이동/속도 제어 (키보드 입력 유지)
  - 연관 피처: 카메라 추적, Listening Circle 위치 갱신, 몬스터 추적 AI
  - 검증:
    - 조이스틱 방향에 맞게 캐릭터가 이동
    - 대각선 입력이 8방향으로 자연스럽게 반영

- [x] P1-04 Listening Circle 렌더링 및 충돌 감지 레이어
  - 구현 피처: 캐릭터 기준 반투명 원 렌더링, 몬스터 진입 감지 (충돌 레이어 구성)
  - 연관 피처: 몬스터 음계 재생 트리거, 판정 시스템
  - 검증:
    - 원이 캐릭터와 함께 이동하며 일정 반경을 유지
    - 몬스터가 원에 들어오면 이벤트가 발생

- [ ] P1-05 카메라 플레이어 추적 (중앙 고정)
  - 구현 피처: 카메라가 플레이어를 따라가며 화면 중앙 유지, UI는 화면 고정
  - 연관 피처: 이동/조이스틱 입력, UI 레이아웃
  - 검증:
    - 플레이어 이동 시 화면이 따라가며 플레이어가 중앙에 유지됨
    - UI(조이스틱/건반/점수/체력/스테이지)가 화면에 고정됨

- [ ] P1-06 플레이어 스프라이트 에셋 적용 (player1)
  - 구현 피처: player1 에셋으로 Idle/Walk 애니메이션 구성
  - 연관 피처: 입력 이동 로직, 애니메이션 전환
  - 검증:
    - Idle 상태에서 player1 idle 애니메이션이 재생됨
    - 이동 시 player1 walk 애니메이션으로 전환됨

- [x] P1-07 홈 화면 UX
  - 구현 피처: 게임 시작 전 타이틀, 안내 텍스트, Start 버튼을 보여주는 홈 화면 오버레이
  - 연관 피처: 오버레이 시스템, 게임 시작/스테이지 관리, 오디오 잠금 해제
  - 검증:
    - 앱 실행 시 스플래시 오버레이 후 home 오버레이가 나타나며, 타이틀/가이드 텍스트/버튼이 화면 중앙에 표시됨
    - Start 버튼을 누르면 `HomeViewModel`이 `isStarting` 상태로 변경되고 `HearOGame.startGame()` 콜백이 실행되어 오버레이가 닫힘

- [x] P1-08 홈 화면 MVI 구조
  - 구현 피처: `presentation/home`에 Intent/State/ViewModel/Screen을 갖춘 MVI 구성, Start 버튼은 ViewModel에 Intent로 전달
  - 연관 피처: 홈 오버레이, 시작 로직, 오버레이 상태 흐름
  - 검증:
    - `HomeViewModel`이 `HomeState` 스트림을 브로드캐스트하며 `isStarting` 값으로 버튼을 disable/enable
    - `StartGameIntent`을 받으면 `HomeState(isStarting: true)`를 emit하고 `onStart` 콜백을 호출하여 `HearOGame`이 시작됨

- [x] P1-09 스플래시 화면 MVI 구조
  - 구현 피처: `presentation/splash`에 Intent/State/ViewModel/Screen을 갖춘 MVI 구성, 자동으로 홈 화면을 트리거
  - 연관 피처: 오버레이 흐름, 홈 오버레이 실행 시점
  - 검증:
    - 앱 실행 시 스플래시 오버레이가 처음 등장하고 1.5초(30 tick) 후 `HearOGame.splashOverlayId`가 닫히며 home 화면 오버레이가 열림
    - `SplashViewModel`이 타이머 기반으로 `progress` 값을 emit하고 완료 시 `onComplete` 콜백으로 홈 오버레이를 트리거함

- [ ] P1-10 세이브 파일 선택 UI
  - 구현 피처: 홈 오버레이에 최근/저장된 세이브 슬롯 카드 리스트를 추가하여 유저가 원하는 세이브를 직접 선택하게 함
  - 연관 피처: HomeViewModel 상태 스트림, 선택된 슬롯 강조, Start 버튼을 눌렀을 때 슬롯 아이디를 기반으로 게임 시작 준비
  - 검증:
    - HomeViewModel이 기본 세이브 슬롯 목록(`Slot 01`, `Slot 02`, …)을 브로드캐스트하고 첫 슬롯이 기본 선택으로 강조됨
    - 슬롯을 터치하면 `SelectSaveIntent`가 발행되어 `selectedSaveId`가 변경되고, UI에서 선택된 슬롯 카드의 테두리가 강조됨
    - `Start Adventure` 버튼은 선택된 슬롯을 기반으로 게임을 시작하도록 준비되어 있어야 하며, 슬롯 데이터는 향후 저장 로직을 위한 기반으로 출력 가능함

- [x] P1-11 게임 배경색을 밝은 테마로 변경
  - 구현 피처: `MaterialApp`/`Scaffold`와 `HearOGame`의 배경을 흰색으로 변경하여 전체적으로 라이트 테마를 반영
  - 연관 피처: 홈/스플래시 오버레이 대비, 게임 캔버스 처리, 글씨/버튼 대비 유지
  - 검증:
    - 앱 실행 후 게임 캔버스가 흰색이며 오버레이는 기존 색상을 유지하면서 가독성을 확보함
    - 텍스트/버튼/HUD 요소가 밝은 배경에서도 잘 보이는지 확인

- [ ] P1-12 숲 배경 스타일 적용
  - 구현 피처: 게임 화면 아래에 숲 분위기의 그라디언트+이미지 배경을 배치하고, 게임 캔버스는 투명 처리하여 숲이 비치도록 함
  - 연관 피처: `AspectRatio` 내부 Stack 구조, `ForestBackground` 위젯, `HearOGame.backgroundColor`
  - 검증:
    - `Assets/images/tigerstone4_A.png`를 활용해 트리거된 숲 텍스처가 보이며, 홈/스플래시 오버레이 위에서 뒷배경처럼 나타남
    - 게임 플레이 중에도 숲 배경이 계속 유지되고 UI와 충돌하지 않음
### Phase 2. 사운드 및 몬스터 시스템
- [x] P2-01 오디오 엔진 연동 및 음계별 리소스 확보
  - 구현 피처: audioplayers 연동, 음계별 샘플 재생 (임시 사인파 wav 리소스 포함), 웹 자동재생 제한 대응 오버레이
  - 연관 피처: 몬스터 음계 트리거, 건반 입력 피드백
  - 검증:
    - 지정한 음계가 즉시 재생되고 중복 재생 시 안정적으로 처리
    - `flutter run -d chrome` 실행 후 A/S/D/F/G/H/J 키로 음계 재생 확인

- [x] P2-02 몬스터 스폰 시스템 (화면 밖 생성 후 캐릭터 추적)
  - 구현 피처: 스폰 타이머, 오프스크린 생성, 추적 이동 (placeholder 몬스터)
  - 연관 피처: 난이도 매니저, 스테이지별 속도 변경
  - 검증:
    - 몬스터가 화면 밖에서 생성되어 캐릭터 방향으로 이동

- [x] P2-03 몬스터별 고유 음계 할당 및 Listening Circle 진입 재생
  - 구현 피처: 몬스터 생성 시 음계 할당, Listening Circle 진입 시 음계 재생
  - 연관 피처: 판정 시스템, 오디오 엔진
  - 검증:
    - 동일 몬스터는 동일 음계를 유지
    - 원 진입 시 음계가 재생됨

- [x] P2-04 몬스터 분노 모드 상태 머신
  - 구현 피처: 오답 판정 시 분노 상태 전환, 색상/속도 변화 (임시 키 입력 트리거)
  - 연관 피처: 판정 시스템, 몬스터 이동 로직
  - 검증:
    - X 키 입력 시 분노 상태(색상/속도 증가)로 전환
    - C 키 입력 시 분노 상태 해제

- [ ] P2-05 몬스터 이동 속도 0.5배 조정
  - 구현 피처: 몬스터 기본 이동 속도를 기존 대비 0.5배로 조정
  - 연관 피처: 스테이지별 속도 배율, 분노 모드 속도 증가
  - 검증:
    - 몬스터 이동 속도가 기존 대비 느려짐
    - 분노 모드에서도 기존 대비 0.5배 수준으로 유지됨

### Phase 3. 전투 및 인터페이스
- [x] P3-01 우측 하단 투명 피아노 건반 UI 레이아웃
  - 구현 피처: 도~시 범위 건반 배치, 터치/클릭 인터랙션 영역
  - 연관 피처: 오디오 엔진, 판정 시스템
  - 검증:
    - 각 건반을 눌렀을 때 시각적 피드백이 표시

- [x] P3-02 건반 입력값과 근접 몬스터 음계 비교 (판정 시스템)
  - 구현 피처: 입력 음계 vs 몬스터 음계 비교, 정답/오답 결과 산출
  - 연관 피처: 몬스터 소멸, 분노 모드 전환, 보상 시스템
  - 검증:
    - 정답 입력 시 몬스터가 소멸하고 보상이 발생
    - 오답 입력 시 몬스터가 분노 상태로 전환

- [x] P3-03 황금 음표 드랍 및 점수 획득 시스템
  - 구현 피처: 보상 오브젝트 생성, 점수 누적 (임시 고정 점수), 점수 HUD 표시
  - 연관 피처: UI 점수 표시, 난이도에 따른 보상 크기
  - 검증:
    - 정답 처리 시 황금 음표가 생성되고 점수가 증가

- [x] P3-04 캐릭터 HP 시스템 및 충돌 무적 시간
  - 구현 피처: 하트 12개 표시, 충돌 시 감소, 무적 시간 부여 (임시 UI)
  - 연관 피처: 게임 오버 처리, UI 상태 표시
  - 검증:
    - 몬스터와 충돌 시 하트가 1 감소
    - 무적 시간 동안 추가 충돌이 무시됨

- [x] P3-05 하트 최대치 조정 (12개)
  - 구현 피처: 기본 하트 최대치를 12개로 조정
  - 연관 피처: HP 시스템, 게임 오버 판정
  - 검증:
    - 하트 UI가 12개로 표시됨
    - 충돌 시 하트가 1개씩 감소함

### Phase 4. 스테이지 및 보스전
- [x] P4-01 30초 단위 난이도 관리 매니저
  - 구현 피처: 타이머 기반 스테이지 전환, 단계 상태 관리, 스테이지 표시 HUD
  - 연관 피처: 몬스터 스폰/속도, 음계 범위 변경
  - 검증:
    - 30초 경과 시 스테이지가 전환됨

- [x] P4-02 스테이지별 몬스터 속도 및 음계 범위 동적 변경
  - 구현 피처: 스테이지별 이동 속도/음계 풀 적용
  - 연관 피처: 스폰 시스템, 판정 시스템
  - 검증:
    - 각 스테이지에서 지정된 음계 범위가 적용됨

- [x] P4-03 보스 몬스터 AI
  - 구현 피처: 고정 위치, 원거리 투사체, 랜덤 음계 변경
  - 연관 피처: 판정 시스템, HP 시스템, 스테이지 관리
  - 검증:
    - 보스가 고정 위치에서 공격하고, 정답 입력 시 음계가 변경됨
    - 총 10회 정답 시 보스가 처치됨

- [x] P4-04 클리어 기록 및 게임 오버 화면
  - 구현 피처: 게임 오버 및 클리어 화면, 기록 저장/표시 (임시 오버레이)
  - 연관 피처: HP 시스템, 스테이지 전환
  - 검증:
    - 하트 0 도달 시 게임 오버 화면이 표시
    - 보스 처치 시 클리어 화면이 표시
